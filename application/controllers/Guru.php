<?php class guru extends CI_Controller{function __construct(){parent::__construct();$this->load->model('Model_guru');}public function index(){$data['title']=' | Data guru';$data['datas']=$this->Model_guru->tampil();$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/data',$data);$this->load->view('templates/backend/footer');}public function cari(){$data['title']=' | Data guru';$p=$this->input->post('keyword');$data['datas']=$this->Model_guru->cariguru($p);$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/data',$data);$this->load->view('templates/backend/footer');}public function tambah(){$data['title']=' | Tambah Data guru  ';$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/tambah');$this->load->view('templates/backend/footer');}public function save_guru(){$this->form_validation->set_message('pesan','Kolom {field] Harus Diisi.!');$this->form_validation->set_rules('nig','guru','trim|required');$this->form_validation->set_rules('nama_guru','nama','trim|required');$this->form_validation->set_rules('alamat','Jumlah Orang','trim|required');$this->form_validation->set_rules('status_guru','Jumlah Orang','trim|required');$this->form_validation->set_rules('telepon','Jumlah Ruangan','trim|required');$this->form_validation->set_rules('pendidikan','Jumlah Pembahasan','trim|required');if($this->form_validation->run()==FALSE){$this->session->set_flashdata('pesan','<div class="alert alert-danger">Gagal Menambah Data.!</div>');redirect('guru/index','refresh');}else{$this->Model_guru->saveguru();}}public function edit($id_guru){$where=array('id_user'=>$id_guru);$data['datas']=$this->Model_guru->tampileditguru($where);$data['title']=' | Edit Data guru ';$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/edit',$data);$this->load->view('templates/backend/footer');}public function update_guru($id_guru){$where=array('id_user'=>$id_guru);$this->Model_guru->updateguru($where);}public function hapus($id_guru){$where=array('id_guru'=>$id_guru);$this->db->where($where);$this->db->delete('tb_guru');$this->session->set_flashdata('pesan','<div class="alert alert-success">Berhasil Menghapus Data.!</div>');redirect('guru/index','refresh');}public function detail_guru($id_guru){$where=$id_guru;$t['title']=' | Detail Data guru';$data['datas']=$this->Model_guru->tampildetails($where);$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/detail',$data);$this->load->view('templates/backend/footer');}function tabungan(){$where=['id_user'=>$this->input->get('id')];$this->db->where($where);$data['identitas']=$this->db->get('tb_users')->row();$this->db->where($where);$data['tabungan']=$this->db->get('tb_tabungan')->result();$this->db->where($where);$this->db->select_sum('jumlah_nabung');$sql=$this->db->get('tb_tabungan')->row();if(empty($sql->jumlah_nabung)){$data['tb_masuk']=0;}else{$data['tb_masuk']=$sql->jumlah_nabung;}$this->db->where($where);$this->db->select_sum('jumlah_ambil');$sql=$this->db->get('tb_tabungan')->row();if(empty($sql->jumlah_ambil)){$data['tb_keluar']=0;}else{$data['tb_keluar']=$sql->jumlah_ambil;}$this->load->view('templates/backend/header');$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/detailtabungan',$data);$this->load->view('templates/backend/footer');}function pinjaman(){$where=['id_user'=>$this->input->get('id')];$this->db->where($where);$data['identitas']=$this->db->get('tb_users')->row();$this->db->where(['id_user'=>$this->input->get('id')]);$data['pinjaman']=$this->db->get('tb_pinjaman')->result();$this->db->where($where);$this->db->select_sum('jumlah_bayar');$sql=$this->db->get('tb_pinjaman')->row();if(empty($sql->jumlah_bayar)){$data['pin_masuk']=0;}else{$data['pin_masuk']=$sql->jumlah_bayar;}$this->db->where($where);$this->db->select_sum('jumlah_pinjam');$sql=$this->db->get('tb_pinjaman')->row();if(empty($sql->jumlah_pinjam)){$data['pin_keluar']=0;}else{$data['pin_keluar']=$sql->jumlah_pinjam;}$this->load->view('templates/backend/header');$this->load->view('templates/backend/sidebar');$this->load->view('backend/guru/detailpinjaman',$data);$this->load->view('templates/backend/footer');}}