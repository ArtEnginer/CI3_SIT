<?php class Siswa extends CI_Controller{function __construct(){parent::__construct();$this->load->model('Model_siswa');}public function index(){$data['title']=' | Data Siswa';$data['datas']=$this->Model_siswa->tampil();$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/data',$data);$this->load->view('templates/backend/footer');}public function cari(){$data['title']=' | Data Siswa';$p=$this->input->post('keyword');$data['datas']=$this->Model_siswa->carisiswa($p);$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/data',$data);$this->load->view('templates/backend/footer');}public function tambah(){$data['title']=' | Tambah Data Siswa  ';$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/tambah');$this->load->view('templates/backend/footer');}public function save_siswa(){$this->form_validation->set_message('pesan','Kolom {field] Harus Diisi.!');$this->form_validation->set_rules('nis','siswa','trim|required');$this->form_validation->set_rules('nama_siswa','nama','trim|required');$this->form_validation->set_rules('jk','Jumlah Orang','trim|required');$this->form_validation->set_rules('alamat','Jumlah Orang','trim|required');$this->form_validation->set_rules('no_telp','Jumlah Ruangan','trim|required');$this->form_validation->set_rules('id_kelas','Jumlah Pembahasan','trim|required');$this->form_validation->set_rules('id_jurusan','Lama Waktu','trim|required');if($this->form_validation->run()==FALSE){$this->session->set_flashdata('pesan','<div class="alert alert-danger">Gagal Menambah Data.!</div>');redirect('siswa/index','refresh');}else{$this->Model_siswa->savesiswa();}}public function edit($id_siswa){$where=array('id_user'=>$id_siswa);$data['datas']=$this->Model_siswa->tampileditsiswa($where);$data['title']=' | Edit Data siswa ';$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/edit',$data);$this->load->view('templates/backend/footer');}public function update_siswa(){$where=array('id_user'=>$this->input->post('id_siswa'));$this->Model_siswa->updatesiswa($where);}public function hapussiswa($id_siswa){$dimana=array('id_siswa'=>$id_siswa);$this->db->where($dimana);$this->db->delete('tb_siswa');$this->session->set_flashdata('pesan','<div class="alert alert-success">Berhasil Menghapus Data.!</div>');redirect('siswa/index','refresh');}public function detail_siswa($id_siswa){$where=$id_siswa;$t['title']=' | Detail Data Siswa';$data['datas']=$this->Model_siswa->tampildetails($where);$this->load->view('templates/backend/header',$data);$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/detail',$data);$this->load->view('templates/backend/footer');}function tabungan(){$where=['id_user'=>$this->input->get('id')];$this->db->where($where);$data['identitas']=$this->db->get('tb_users')->row();$this->db->where($where);$data['tabungan']=$this->db->get('tb_tabungan')->result();$this->db->where($where);$this->db->select_sum('jumlah_nabung');$sql=$this->db->get('tb_tabungan')->row();if(empty($sql->jumlah_nabung)){$data['tb_masuk']=0;}else{$data['tb_masuk']=$sql->jumlah_nabung;}$this->db->where($where);$this->db->select_sum('jumlah_ambil');$sql=$this->db->get('tb_tabungan')->row();if(empty($sql->jumlah_ambil)){$data['tb_keluar']=0;}else{$data['tb_keluar']=$sql->jumlah_ambil;}$this->load->view('templates/backend/header');$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/detailtabungan',$data);$this->load->view('templates/backend/footer');}function pinjaman(){$where=['id_user'=>$this->input->get('id')];$this->db->where($where);$data['identitas']=$this->db->get('tb_users')->row();$this->db->where(['id_user'=>$this->input->get('id')]);$data['pinjaman']=$this->db->get('tb_pinjaman')->result();$this->db->where($where);$this->db->select_sum('jumlah_bayar');$sql=$this->db->get('tb_pinjaman')->row();if(empty($sql->jumlah_bayar)){$data['pin_masuk']=0;}else{$data['pin_masuk']=$sql->jumlah_bayar;}$this->db->where($where);$this->db->select_sum('jumlah_pinjam');$sql=$this->db->get('tb_pinjaman')->row();if(empty($sql->jumlah_pinjam)){$data['pin_keluar']=0;}else{$data['pin_keluar']=$sql->jumlah_pinjam;}$this->load->view('templates/backend/header');$this->load->view('templates/backend/sidebar');$this->load->view('backend/siswa/detailpinjaman',$data);$this->load->view('templates/backend/footer');}} ?>